---
title: 20210605の調べ
date: 2021-06-05 21:43:37
tags:
---

## Anthos
- Problem, Context
    - 100%クラウド！とはなかなか行かず、クラウドとオンプレを上手く組み合わせる”Hybrid Cloud"を採用せざるを得ないケースが、現実問題として多い
    - Hybrid Cloudの目的
        - データの機密性に応じて使い分ける
        - 高負荷時、クラウドで負荷分散させる
        - など
    - しかし、Hybrid Cloudは当然、構成や運用が複雑になりがち

- Anthos as a Solution
    - オンプレ、クラウド　で統一的にコンテナ管理する仕組みを提供する
        - オンプレはAnthos GKEベースのKubernatesを動かす必要あり
        - クラウド
            - GCPだとGKE
            - AWSだと、Anthos Clusters for AWS
    - Service Mesh (Istio)

## 分散トランザクション
- これがわかりやすいね
    - [Distributed Transactions: The Icebergs of Microservices • Evolvable MeEvolvable Me](https://www.grahamlea.com/2016/08/distributed-transactions-microservices-icebergs/)

- データの整合性
    - 厳密な整合性 vs BASE（結果整合性）
    - 厳密な整合性
        - 2PC, XA(DBの機能で実現)
    - BASEなアプローチ
        - Message Broker
        - transaction発行元サービスがcoordinationする
            - TCC (Try/Confirm/Cancel)
            - State Machineを持つ
    - 補償トランザクション
    - データのリコンサイル

事例
- アリペイ
- メルペイ
    - [マイクロサービスにおける決済トランザクション管理 \| メルカリエンジニアリング](https://engineering.mercari.com/blog/entry/2019-06-07-155849/)